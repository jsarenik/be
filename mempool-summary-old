<!-- options keys:--><!-- 		- blockHeightsByTxid--><!-- 		- sharedBlockHeight (int)--><!-- 		- showDates (true|false)--><!-- 		- highlightAddress (address)--><!-- 		- addrGainsByTxid (map)--><!-- 		- addrLossesByTxid (map)--><!-- 		- mempoolDetailsByTxid (map)--><!-- txBlockHeightsByTxid_orSharedBlockHeight, showDates=false, highlightAddress, addrGainsByTxid, addrLossesByTxid)--><!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="/"><meta name="csrf-token" content="bL6wU3pw-W2TkAAH0piBAssvfL7VH2syhMT0"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0, shrink-to-fit=no"><meta name="description" content="Open-source, easy-to-use, educational Bitcoin explorer whose only dependency is your Bitcoin Core node."><link rel="stylesheet" href="./style/highlight.min.css?v=2023-06-14-1dbd3d8fc2" integrity="sha384-s4RLYRjGGbVqKOyMGGwfxUTMOO6D7r2eom7hWZQ6BjK2Df4ZyfzLXEkonSm0KLIQ" crossorigin="anonymous"><link id="dark-v1-theme-link-tag" href="./style/dark-v1.min.css?v=2023-06-14-1dbd3d8fc2" integrity="sha384-N4vpIzX+w8OiVt/PRWfSTxIBA/r/2wp/9H3d3Qxmb/6woHCt9/HZQl9Nc3XByIqU" crossorigin="anonymous"/><link id="light-theme-link-tag" href="./style/light.min.css?v=2023-06-14-1dbd3d8fc2" integrity="sha384-oFtx78mBk7Y/IOR4rl1Ij5Wf3/5FnXjwqcmvYpdvI/piekQkeaq72KSZjWUc3Uaw" crossorigin="anonymous"/><link id="dark-theme-link-tag" rel="stylesheet" href="./style/dark.min.css?v=2023-06-14-1dbd3d8fc2" integrity="sha384-CZz6XiKcNpqio2wvNlCOZ/wEbjjS0Z7W7+zn6bzl5kfs5VS9nFi/jzIAxIobXrtg" crossorigin="anonymous"/><style>@font-face {
	font-family: "bootstrap-icons";

	src:	url("./font/bootstrap-icons.woff2?v=2023-06-14-1dbd3d8fc2") format("woff2"),
			url("./font/bootstrap-icons.woff?v=2023-06-14-1dbd3d8fc2") format("woff");
}
</style><link rel="stylesheet" href="./style/bootstrap-icons.css?v=2023-06-14-1dbd3d8fc2" integrity="sha384-rJFhkIguED0Z4GX6r6ReHpTCkwWtiPHZnQtWVP0DQWcKHzeJAlYb1m/xdYkeEk+f" crossorigin="anonymous"/><link id="canonical" rel="canonical" href="https://bitcoinexplorer.org"><meta property="og:title" content="BitcoinExplorer.org - Open-Source Bitcoin Explorer"><meta property="og:description" content="Open-source, easy-to-use, educational Bitcoin explorer whose only dependency is your Bitcoin Core node."><meta property="og:image" content="https://bitcoinexplorer.org/img/preview.png"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@BitcoinExplorer"><meta property="twitter:creator" content="@BitcoinExplorer"><meta property="twitter:title" content="BitcoinExplorer.org"><meta property="twitter:description" content="Open-source, easy-to-use, educational Bitcoin explorer whose only dependency is your Bitcoin Core node."><meta property="twitter:image:src" content="https://bitcoinexplorer.org/img/preview.png"><meta property="twitter:domain" content="bitcoinexplorer.org"><link rel="apple-touch-icon" sizes="180x180" href="./img/network-mainnet/apple-touch-icon.png?v=2023-06-14-1dbd3d8fc2"><link rel="icon" type="image/png" sizes="32x32" href="./img/network-mainnet/favicon-32x32.png?v=2023-06-14-1dbd3d8fc2"><link rel="icon" type="image/png" sizes="16x16" href="./img/network-mainnet/favicon-16x16.png?v=2023-06-14-1dbd3d8fc2"><link rel="manifest" href="./img/network-mainnet/site.webmanifest"><link rel="mask-icon" href="./img/network-mainnet/safari-pinned-tab.svg" color="#f7931a"><link rel="shortcut icon" href="./img/network-mainnet/favicon.ico?v=2023-06-14-1dbd3d8fc2"><meta name="apple-mobile-web-app-title" content="BTC Explorer"><meta name="application-name" content="BTC Explorer"><meta name="msapplication-TileColor" content="#022e70"><meta name="msapplication-config" content="./img/network-mainnet/browserconfig.xml"><meta name="theme-color" content="#022e70"><!-- debug as if we're in privacy mode (which means we don't have exchange rate data)--><!-- debug as if we're in performance protection mode (which means we don't calculate UTXO set details)--><!-- debug as if we don't have result.blockstats (applies to block pages when node version < 0.17.0)--><!--if (result)--><!--	- result.blockstats = null;--><!-- no networkVolume--><title>Mempool Summary</title></head><body class="bg-header-footer"><nav class="navbar navbar-expand-md navbar-dark bg-header-footer"><div class="container"><a class="navbar-brand" href="./"><span><img class="header-image" src="./img/network-mainnet/logo.svg?v=2023-06-14-1dbd3d8fc2" alt="logo"><span class="fw-light">Bitcoin</span></span></a><button class="navbar-toggler navbar-toggler-end" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-label="collapse navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNav"><ul class="navbar-nav me-auto"></ul><ul class="navbar-nav"><li class="nav-item dropdown me-0 me-md-2 mt-2 mt-md-0 text-center text-md-start"><a class="nav-link rounded bg-header-footer-highlight text-white dropdown-toggle" href="javascript:void(0)" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="bi-tools me-2 ms-1"></i></a><div class="dropdown-menu dropdown-menu-end shadow" aria-label="Tools Items"><span class="dropdown-header">Basics</span><a class="dropdown-item" href="./node-details"><i class="bi-info-circle" style="width: 20px; margin-right: 10px;"></i><span> Node Details</span></a><a class="dropdown-item" href="./blocks"><i class="bi-boxes" style="width: 20px; margin-right: 10px;"></i><span> Browse Blocks</span></a><hr class="dropdown-divider mt-2 mb-1"><span class="dropdown-header">Mempool</span><a class="dropdown-item" href="./mempool-summary"><i class="bi-hourglass-split" style="width: 20px; margin-right: 10px;"></i><span> Mempool Summary</span></a><a class="dropdown-item" href="./next-block"><i class="bi-minecart-loaded" style="width: 20px; margin-right: 10px;"></i><span> Next Block</span></a><a class="dropdown-item" href="./mempool-transactions"><i class="bi-book" style="width: 20px; margin-right: 10px;"></i><span> Browse Mempool</span></a><hr class="dropdown-divider mt-2 mb-1"><span class="dropdown-header">Analysis</span><a class="dropdown-item" href="./mining-summary"><i class="bi-hammer" style="width: 20px; margin-right: 10px;"></i><span> Mining Summary</span></a><a class="dropdown-item" href="./utxo-set"><i class="bi-list-columns" style="width: 20px; margin-right: 10px;"></i><span> UTXO Set</span></a><a class="dropdown-item" href="./block-stats"><i class="bi-stack" style="width: 20px; margin-right: 10px;"></i><span> Block Stats</span></a><a class="dropdown-item" href="./block-analysis"><i class="bi-chevron-double-down" style="width: 20px; margin-right: 10px;"></i><span> Block Analysis</span></a><a class="dropdown-item" href="./difficulty-history"><i class="bi-clock-history" style="width: 20px; margin-right: 10px;"></i><span> Difficulty History</span></a><a class="dropdown-item" href="./tx-stats"><i class="bi-graph-up" style="width: 20px; margin-right: 10px;"></i><span> Transaction Stats</span></a><a class="dropdown-item" href="./next-halving"><i class="bi-square-half" style="width: 20px; margin-right: 10px;"></i><span> Next Halving</span></a><hr class="dropdown-divider mt-2 mb-1"><span class="dropdown-header">Technical</span><a class="dropdown-item" href="./api/docs"><i class="bi-braces-asterisk" style="width: 20px; margin-right: 10px;"></i><span> API</span></a><a class="dropdown-item" href="./rpc-browser"><i class="bi-journal-text" style="width: 20px; margin-right: 10px;"></i><span> RPC Browser</span></a><a class="dropdown-item" href="./rpc-terminal"><i class="bi-terminal" style="width: 20px; margin-right: 10px;"></i><span> RPC Terminal</span></a><a class="dropdown-item" href="./peers"><i class="bi-diagram-3" style="width: 20px; margin-right: 10px;"></i><span> Peers</span></a><hr class="dropdown-divider mt-2 mb-1"><span class="dropdown-header">Fun</span><a class="dropdown-item" href="./fun"><i class="bi-flag" style="width: 20px; margin-right: 10px;"></i><span> Bitcoin Fun</span></a><a class="dropdown-item" href="./quotes"><i class="bi-chat-quote" style="width: 20px; margin-right: 10px;"></i><span> Quotes</span></a><a class="dropdown-item" href="./holidays"><i class="bi-calendar-heart" style="width: 20px; margin-right: 10px;"></i><span> Holidays</span></a><a class="dropdown-item" href="./bitcoin-whitepaper"><i class="bi-file-earmark-text" style="width: 20px; margin-right: 10px;"></i><span> Whitepaper Extractor</span></a></div></li><li class="nav-item dropdown me-0 me-md-3 mt-2 mt-md-0 text-center text-md-start"><a class="nav-link rounded bg-header-footer-highlight text-white dropdown-toggle" href="javascript:void(0)" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="bi-gear me-2 ms-1"></i></a><div class="dropdown-menu dropdown-menu-end shadow" aria-labelledby="navbarDropdown"><span class="dropdown-header">Display Currency</span><div class="btn-group ms-3"><span class="btn btn-primary btn-sm">BTC</span><a class="btn btn-outline-primary btn-sm" href="./changeSetting?name=displayCurrency&amp;value=sat">sat</a></div><hr class="dropdown-divider mt-2 mb-2"><span class="dropdown-header">Theme</span><div class="btn-group ms-3"><a class="btn btn-sm px-3 btn-outline-primary" id="theme-toggler-light" href="javascript:void(0);" onclick="activateTheme('light'); return false;"><i class="bi-sun-fill text-warning"></i></a><a class="btn btn-sm px-3 btn-primary" id="theme-toggler-dark" href="javascript:void(0);" onclick="activateTheme('dark'); return false;"><i class="bi-moon-fill"></i></a><a class="btn btn-sm px-3 btn-outline-primary" id="theme-toggler-dark-v1" href="javascript:void(0);" onclick="activateTheme('dark-v1'); return false;"><i class="bi-moon"></i></a></div><hr class="dropdown-divider mt-2 mb-2"><span class="dropdown-header">Display Timezone</span><div class="btn-group ms-3"><a class="btn btn-sm px-3 btn-primary" href="./changeSetting?name=uiTimezone&amp;value=utc">UTC</a><a class="btn btn-sm px-3 btn-outline-primary" href="./changeSetting?name=uiTimezone&amp;value=local">Local</a></div><p class="px-3 pt-2 small text-muted">"Local" uses your browser's default offset:<span class="badge bg-light text-dark ms-1 border" id="browser-tz-offset"></span><i class="bi-info-circle ms-1" title="This value comes from your brower. If you wish to set a custom offset, you can do so below, in 'More settings...'" data-bs-toggle="tooltip"></i></p><hr class="dropdown-divider mt-2 mb-2"><a class="dropdown-item" href="./user-settings">More settings...</a><a class="dropdown-item" href="./admin/dashboard">Admin Dashboard</a></div></li></ul></div><form class="form-inline d-none d-lg-inline" method="post" action="./search" style="width: 325px;" autocomplete="off"><input type="hidden" name="_csrf" value="bL6wU3pw-W2TkAAH0piBAssvfL7VH2syhMT0"><div class="input-group"><input class="form-control" type="text" name="query" placeholder="block height/hash, txid, address" autocorrect="off" autocapitalize="off" tabindex="1"><button class="btn btn-primary" type="submit" aria-label="Search"><i class="bi-search"></i></button></div></form><form class="form-inline d-lg-none w-100 mt-2 mt-md-0" method="post" action="./search"><input type="hidden" name="_csrf" value="bL6wU3pw-W2TkAAH0piBAssvfL7VH2syhMT0"><div class="input-group"><input class="form-control" type="text" name="query" placeholder="height/hash/txid..."><button class="btn btn-primary" type="submit" aria-label="Search"><i class="bi-search"></i></button></div></form></div></nav><div class="pb-4 pt-3 pt-md-4 bg-main"><div class="container px-2 px-sm-3 mb-large"><div style="min-height: 500px;"><div class="d-flex justify-content-between"><h1 class="fw-light word-wrap mb-1">Mempool Summary</h1></div><h4 class="fw-light word-wrap mb-4"></h4><!--hr.mb-3--><div class="alert alert-primary alert-dismissible shadow-sm mb-4 ps-3 ps-md-7" role="alert"><i class="d-none d-md-inline bi-info-circle fs-5 d-inline-block" style="position: absolute; top: 0; left: 0; width: 36px; margin-left: 0.75rem; margin-top: 1.0rem;"></i><div class="mb-2">This tool summarizes data about the transactions in your node's <b>mempool</b> - the set of transactions that your node has received from the network but are not yet confirmed in a block.</div><div class="mb-0">The fee-rate summary data can be helpful for deciding what fee is necessary to get a transaction included in a future block, depending on its priority.</div><a class="btn-close" href="./changeSetting?name=mempoolSummaryNoteDismissed&amp;value=true" aria-label="Close" style="text-decoration: none;" title="Hide this note" data-bs-toggle="tooltip"></a><!--button.btn-close.text-muted(type="button", data-bs-dismiss="alert", aria-label="Close", title="Hide this note", data-bs-toggle="tooltip")--></div><div class="mb-huge" id="progress-wrapper"><div class="card shadow-sm mb-3"><div class="card-body"><div class="d-flex align-items-center"><div class="spinner-border spinner-border-sm text-primary me-2 ms-2"></div><span class="fw-bold me-2">Loading:</span><span class="fw-light" id="progress-text">...</span></div><div class="progress mt-2" id="progress-bar" style="height: 7px;"><div class="progress-bar" id="data-progress" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div></div><div class="loading-error"></div></div></div></div><div id="main-content" style="display: none;"><h3 class="h5 mb-1 fw-light d-block">Summary</h3><div class="mb-section"><div class="card mb-section shadow-sm"><div class="card-body"><!--h1 #{itemCount} #{JSON.stringify(locals.rowCounts)}--><div class="row row-cols-1 summary-row row-cols-sm-1 row-cols-md-3 row-cols-lg-4 row-cols-xl-5"><div class="col mb-3 mb-sm-4 mb-md-4 mb-lg-4 mb-xl-0"><!--span.text-danger (#{JSON.stringify(locals.rowCounts)})--><div class="text-start text-md-center"><span class="fs-6 text-uppercase fw-light text-card-highlight" data-bs-toggle="tooltip" data-bs-html="true">Transactions</span></div><div class="lead text-start text-md-center"><span id="tx-count"></span></div></div><div class="col mb-3 mb-sm-4 mb-md-4 mb-lg-4 mb-xl-0"><!--span.text-danger (#{JSON.stringify(locals.rowCounts)})--><div class="text-start text-md-center"><span class="fs-6 text-uppercase fw-light text-card-highlight border-dotted" title="The number of blocks filled by all current mempool transactions." data-bs-toggle="tooltip" data-bs-html="true">Blocks</span></div><div class="lead text-start text-md-center"><span id="block-count"></span></div></div><div class="col mb-3 mb-sm-4 mb-md-4 mb-lg-4 mb-xl-0"><!--span.text-danger (#{JSON.stringify(locals.rowCounts)})--><div class="text-start text-md-center"><span class="fs-6 text-uppercase fw-light text-card-highlight" data-bs-toggle="tooltip" data-bs-html="true">Total Fees</span></div><div class="lead text-start text-md-center"><span id="total-fees"></span></div></div><div class="col mb-3 mb-sm-4 mb-md-0 mb-lg-4 mb-xl-0"><!--span.text-danger (#{JSON.stringify(locals.rowCounts)})--><div class="text-start text-md-center"><span class="fs-6 text-uppercase fw-light text-card-highlight" data-bs-toggle="tooltip" data-bs-html="true">Avg Fee</span></div><div class="lead text-start text-md-center"><span id="avg-fee"></span></div></div><div class="col mb-0 mb-sm-0 mb-md-0 mb-lg-0 mb-xl-0"><!--span.text-danger (#{JSON.stringify(locals.rowCounts)})--><div class="text-start text-md-center"><span class="fs-6 text-uppercase fw-light text-card-highlight me-2" data-bs-toggle="tooltip" data-bs-html="true">Avg Fee Rate</span><small class="text-card-highlight fw-light">(<span data-bs-toggle="tooltip" data-bs-html="true">sat/vB</span>)</small></div><div class="lead text-start text-md-center"><span id="avg-fee-rate"></span></div></div></div></div></div></div><h3 class="h5 mb-1 fw-light d-block">Estimate Block Depth</h3><div class="mb-section"><div class="card mb-section shadow-sm"><div class="card-body"><p>If you already have a transaction in the mempool, you can enter its <b>TXID</b> to get an estimate for when it will be included in a block. Or, if you're planning to send a transaction, you can estimate confirmation time for different fee rates.</p><div class="clearfix"><div class="float-start"><div class="me-4 d-inline-block mb-3"><h6 class="text-card-highlight fw-light"><span class="text-uppercase">Fee Rate</span><small class="ms-1">(sat/vB)</small></h6><div class="btn-group"><a class="btn btn-outline-primary fee-rate-btn" href="javascript:void(0)" onclick="estimateMempoolDepth(parseInt($(this).attr(&quot;data-fee-rate&quot;))); return false;" data-fee-rate="1">1</a><a class="btn btn-outline-primary fee-rate-btn" href="javascript:void(0)" onclick="estimateMempoolDepth(parseInt($(this).attr(&quot;data-fee-rate&quot;))); return false;" data-fee-rate="2">2</a><a class="btn btn-outline-primary fee-rate-btn" href="javascript:void(0)" onclick="estimateMempoolDepth(parseInt($(this).attr(&quot;data-fee-rate&quot;))); return false;" data-fee-rate="3">3</a><a class="btn btn-outline-primary fee-rate-btn" href="javascript:void(0)" onclick="estimateMempoolDepth(parseInt($(this).attr(&quot;data-fee-rate&quot;))); return false;" data-fee-rate="4">4</a><a class="btn btn-outline-primary fee-rate-btn" href="javascript:void(0)" onclick="estimateMempoolDepth(parseInt($(this).attr(&quot;data-fee-rate&quot;))); return false;" data-fee-rate="5">5</a><a class="btn btn-outline-primary fee-rate-btn" href="javascript:void(0)" onclick="estimateMempoolDepth(parseInt($(this).attr(&quot;data-fee-rate&quot;))); return false;" data-fee-rate="15">15</a><a class="btn btn-outline-primary fee-rate-btn" href="javascript:void(0)" onclick="estimateMempoolDepth(parseInt($(this).attr(&quot;data-fee-rate&quot;))); return false;" data-fee-rate="25">25</a><a class="btn btn-outline-primary fee-rate-btn" href="javascript:void(0)" onclick="estimateMempoolDepth(parseInt($(this).attr(&quot;data-fee-rate&quot;))); return false;" data-fee-rate="50">50</a><a class="btn btn-outline-primary fee-rate-btn" href="javascript:void(0)" onclick="estimateMempoolDepth(parseInt($(this).attr(&quot;data-fee-rate&quot;))); return false;" data-fee-rate="75">75</a><a class="btn btn-outline-primary fee-rate-btn" href="javascript:void(0)" onclick="estimateMempoolDepth(parseInt($(this).attr(&quot;data-fee-rate&quot;))); return false;" data-fee-rate="100">100</a><a class="btn btn-outline-primary fee-rate-btn" href="javascript:void(0)" onclick="estimateMempoolDepth(parseInt($(this).attr(&quot;data-fee-rate&quot;))); return false;" data-fee-rate="150">150</a></div></div><div class="me-4 d-inline-block mb-3"><h6 class="text-card-highlight text-uppercase fw-light">Transaction ID</h6><form class="form-inline" method="post" action="javascript:void(0)" onsubmit="estimateTransactionMempoolDepth($(&quot;#mempoolquery&quot;).val()); return false;" style="width: 325px;"><div class="input-group input-group"><input class="form-control form-control" id="mempoolquery" type="text" name="mempoolquery" placeholder="txid" title="&lt;span class='text-warning'&gt;Transaction not found&lt;/span&gt;" data-bs-trigger="manual" data-bs-html="true" data-bs-placement="bottom"><button class="btn btn-primary" type="submit" aria-label="Search"><i class="bi-search"></i></button></div></form></div><div class="me-4 d-inline-block mb-3"><h6 class="text-card-highlight fw-light"><span class="text-uppercase">Custom Fee Rate</span><small class="ms-1">(sat/vB)</small></h6><form class="form-inline" method="post" action="javascript:void(0)" onsubmit="estimateMempoolDepth($(&quot;#customFeeRate&quot;).val()); return false;" style="width: 200px;"><div class="input-group input-group"><input class="form-control form-control" id="customFeeRate" type="text" name="customFeeRate" placeholder="sat/vB"><button class="btn btn-primary" type="submit" aria-label="Search"><i class="bi-search"></i></button></div></form></div></div></div><hr class="mt-1 mb-3"><!--h1 #{itemCount} #{JSON.stringify(locals.rowCounts)}--><div class="row row-cols-1 summary-row row-cols-sm-1 row-cols-md-3 row-cols-lg-3 row-cols-xl-3"><div class="col mb-3 mb-sm-4 mb-md-0 mb-lg-0 mb-xl-0"><!--span.text-danger (#{JSON.stringify(locals.rowCounts)})--><div class="text-start text-md-center"><span class="fs-6 text-uppercase fw-light text-card-highlight me-2" data-bs-toggle="tooltip" data-bs-html="true">Fee Rate</span><small class="text-card-highlight fw-light">(<span data-bs-toggle="tooltip" data-bs-html="true">sat/vB</span>)</small></div><div class="lead text-start text-md-center"><span id="estimate-fee-rate">-</span></div></div><div class="col mb-3 mb-sm-4 mb-md-0 mb-lg-0 mb-xl-0"><!--span.text-danger (#{JSON.stringify(locals.rowCounts)})--><div class="text-start text-md-center"><span class="fs-6 text-uppercase fw-light text-card-highlight" data-bs-toggle="tooltip" data-bs-html="true">Est. Block Depth</span></div><div class="lead text-start text-md-center"><span id="estimate-mempooldepth">-</span></div></div><div class="col mb-0 mb-sm-0 mb-md-0 mb-lg-0 mb-xl-0"><!--span.text-danger (#{JSON.stringify(locals.rowCounts)})--><div class="text-start text-md-center"><span class="fs-6 text-uppercase fw-light text-card-highlight" data-bs-toggle="tooltip" data-bs-html="true">Est. Confirmation Time</span></div><div class="lead text-start text-md-center"><span id="estimate-conf-time">-</span></div></div></div></div></div></div><div id="detail-charts-and-data"><h3 class="h5 mb-1 fw-light d-block">Fee Rate Distribution</h3><div class="mb-section"><div class="card mb-section shadow-sm"><div class="card-body"><canvas class="mb-3" id="mempoolBarChart" height="100"></canvas><hr class="mt-3"><div class="table-responsive"><table class="table table-striped table-borderless mb-3"><thead><tr><th class="text-card-highlight text-uppercase fw-light">Fee Rate</th><th class="text-end text-card-highlight text-uppercase fw-light">N(tx)</th><th class="text-end text-card-highlight text-uppercase fw-light"><span class="border-dotted" title="The number of blocks filled by all transactions in this fee-rate bucket." data-bs-toggle="tooltip">N(blocks)</span></th><th class="text-end text-card-highlight text-uppercase fw-light"><span class="border-dotted" title="The running total of the number of blocks filled by transactions at this fee-rate and higher." data-bs-toggle="tooltip">Σ N(blocks)</span></th><th class="text-end text-card-highlight text-uppercase fw-light">Σ Fees</th><th class="text-end text-card-highlight text-uppercase fw-light">Avg Fee</th><th class="text-end text-card-highlight fw-light"><span class="text-uppercase">Avg Fee Rate</span><small class="ms-1">(sat/vB)</small></th></tr></thead><tbody id="fee-rate-table-body"><tr id="fee-rate-table-row-prototype" style="display: none;"><td class="data-label"></td><td class="text-end data-count"></td><td class="text-end data-block-count"></td><td class="text-end data-sum-block-count"></td><td class="text-end data-total-fees"></td><td class="text-end data-avg-fee"></td><td class="text-end data-fee-rate"></td></tr><tr id="empty-row-to-fix-striped-coloring" style="display: none;"></tr></tbody></table></div></div></div></div><h3 class="h5 mb-1 fw-light d-block">Size Distribution</h3><div class="mb-section"><div class="card mb-section shadow-sm"><div class="card-body"><canvas class="mb-3" id="txSizesBarChart" height="100"></canvas></div></div></div><h3 class="h5 mb-1 fw-light d-block">Age Distribution</h3><div class="mb-section"><div class="card mb-section shadow-sm"><div class="card-body"><canvas class="mb-3" id="txAgesBarChart" height="100"></canvas></div></div></div><div class="row"><div class="col"><h3 class="h5 mb-1 fw-light d-block">Highest Fee Rate Transactions</h3><div class="mb-section"><div class="card mb-section shadow-sm"><div class="card-body"><div class="table-responsive"><table class="table table-striped table-borderless mb-3"><thead><tr><th class="text-card-highlight text-uppercase fw-light">Txid</th><th class="text-end text-card-highlight fw-light"><span class="text-uppercase">Fee Rate</span><span class="ms-2">(sat/vB)</span></th></tr></thead><tbody id="topfee-tx-table-body"><tr id="topfee-tx-table-row-prototype" style="display: none;"><td class="data-txid"></td><td class="text-end data-feerate"></td></tr><tr id="empty-row-to-fix-striped-coloring" style="display: none;"></tr></tbody></table></div></div></div></div></div><div class="col"><h3 class="h5 mb-1 fw-light d-block">Oldest Transactions</h3><div class="mb-section"><div class="card mb-section shadow-sm"><div class="card-body"><div class="table-responsive"><table class="table table-striped table-borderless mb-3"><thead><tr><th class="text-card-highlight text-uppercase fw-light">Txid</th><th class="text-end text-card-highlight text-uppercase fw-light"><span class="border-dotted" title="How long ago this transaction was first seen by your node." data-bs-toggle="tooltip">Age</span></th></tr></thead><tbody id="oldest-tx-table-body"><tr id="oldest-tx-table-row-prototype" style="display: none;"><td class="data-txid"></td><td class="text-end data-age"></td></tr><tr id="empty-row-to-fix-striped-coloring" style="display: none;"></tr></tbody></table></div></div></div></div></div><div class="col"><h3 class="h5 mb-1 fw-light d-block">Largest Transactions</h3><div class="mb-section"><div class="card mb-section shadow-sm"><div class="card-body"><div class="table-responsive"><table class="table table-striped table-borderless mb-3"><thead><tr><th class="text-card-highlight text-uppercase fw-light">Txid</th><th class="text-end text-card-highlight text-uppercase fw-light">Size</th></tr></thead><tbody id="largest-tx-table-body"><tr id="largest-tx-table-row-prototype" style="display: none;"><td class="data-txid"></td><td class="text-end data-size"></td></tr><tr id="empty-row-to-fix-striped-coloring" style="display: none;"></tr></tbody></table></div></div></div></div></div></div></div></div></div><div style="margin-bottom: 30px;"></div></div></div><footer class="footer border-top border-primary bg-header-footer pt-3 pb-1 px-3 text-white" style="border-width: 5px !important;"><div class="container"><div class="mb-4 mx-6"><iframe id="quoteIframe" title="A Bitcoin Quote of the Day" src="./snippet/quote/random" onload="iframeLoaded('quoteIframe');" scrolling="no" height="0" style="width: 100%;"></iframe></div><hr><div class="row mt-4 mb-6"><div class="col-lg-3"><div class="mb-4"><h6>Project</h6><div class="ms-2"><a class="footer-link" href="https://github.com/janoside/btc-rpc-explorer">github.com/janoside/btc-rpc-explorer</a><div class="mt-2"><a class="btn btn-primary btn-sm me-3 mb-1 text-decoration-none" href="https://github.com/janoside/btc-rpc-explorer"><i class="bi-star-fill text-warning me-2"></i><span class="badge bg-white text-dark">1317</span></a><a class="btn btn-primary btn-sm me-3 mb-1 text-decoration-none" href="https://github.com/janoside/btc-rpc-explorer/fork"><i class="bi-bezier2 me-2"></i><span class="badge bg-white text-dark">1070</span></a></div></div></div></div><div class="col-lg-3"><div class="mb-4"><h6>App Details</h6><div class="ms-2"><span>version: 3.4.0</span><br><span>commit: <a class="footer-link" href="https://github.com/janoside/btc-rpc-explorer/commit/1dbd3d8fc2">1dbd3d8fc2</a></span><br><span>released: 2023-06-14</span><span style="font-size: 0.9em;"> (<a class="footer-link" href="./changelog">changelog</a><span>)</span></span></div></div></div><div class="col-lg-3"><div class="mb-4"><h6>Public Demos</h6><div class="ms-2"><a class="footer-link" href="https://be.anyone.eu.org">https://be.anyone.eu.org</a><br><a class="footer-link" href="http://btcexpz7xlwrqknqw6p3bok6shf73qtkd6zxct4x4qta2ktvh7ntprad.onion" title="Tor v3 Hidden Service" data-bs-toggle="tooltip">btcexp….onion</a><span class="ms-1">(tor v3)</span><small class="ms-2"><a href="javascript:void(0)" title="Copy" data-clipboard-text="http://btcexpz7xlwrqknqw6p3bok6shf73qtkd6zxct4x4qta2ktvh7ntprad.onion" data-bs-toggle="tooltip" onclick="copyTextToClipboard(&quot;http://btcexpz7xlwrqknqw6p3bok6shf73qtkd6zxct4x4qta2ktvh7ntprad.onion&quot;); $(this).attr(&quot;title&quot;, &quot;Copied!&quot;).tooltip(&quot;_fixTitle&quot;).tooltip(&quot;show&quot;); $(this).mouseleave(function() { $(this).tooltip(&quot;hide&quot;); $(this).attr(&quot;data-bs-original-title&quot;, &quot;Copy&quot;); });"><i class="bi-clipboard2 text-info"></i></a></small><div class="mt-2"><a class="me-2" href="https://be.anyone.eu.org" title="Bitcoin" data-bs-toggle="tooltip"><img src="./img/network-mainnet/logo.svg?v=2023-06-14-1dbd3d8fc2" alt="Bitcoin" style="width: 40px; height: 40px;"></a><a class="me-2" href="https://testnet.bitcoinexplorer.org" title="Testnet" data-bs-toggle="tooltip"><img src="./img/network-testnet/logo.svg?v=2023-06-14-1dbd3d8fc2" alt="Testnet" style="width: 40px; height: 40px;"></a><a class="me-2" href="https://ex.signet.bublina.eu.org" title="Signet" data-bs-toggle="tooltip"><img src="./img/network-signet/logo.svg?v=2023-06-14-1dbd3d8fc2" alt="Signet" style="width: 40px; height: 40px;"></a></div></div></div></div><div class="col-lg-3"><div class="mb-4"><h6>Links</h6><div class="ms-2"><span style="font-size: 1.5rem;"><a class="text-white mb-1 me-3" href="https://github.com/janoside/btc-rpc-explorer" title="View source code" data-bs-toggle="tooltip"><i class="bi-git"></i></a><a class="text-danger mb-1 me-3" href="https://donate.bitcoinexplorer.org" target="_blank" title="Support this project with a donation" data-bs-toggle="tooltip"><i class="bi-heart-fill text-danger"></i></a><a class="text-white mb-1" href="https://twitter.com/BitcoinExplorer" target="_blank" title="Follow @BitcoinExplorer on Twitter" data-bs-toggle="tooltip"><i class="bi-twitter text-twitter"></i></a></span></div></div></div></div></div></footer><script src="./js/jquery.min.js?v=2023-06-14-1dbd3d8fc2" integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK" crossorigin="anonymous"></script><script src="./js/bootstrap.bundle.min.js?v=2023-06-14-1dbd3d8fc2" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script><script src="./js/site.js?v=2023-06-14-1dbd3d8fc2" integrity="sha384-G8o2io5zIdQiiVN+4CAGGXPO4UvV8jGkSMlfddSPbqIUd3x5Rv01pNH6ec8QOATu" crossorigin="anonymous"></script><script>var serverTzOffset = "0";
var browserTzOffset = "0";
var currentBrowserTzOffset = (new Date().getTimezoneOffset() / 60).toString();
var userTzOffset = "unset";

document.addEventListener("DOMContentLoaded", function(event) {''
	enableTooltipsAndPopovers();

	onLoad_tabSelection();

	//console.log(Intl.DateTimeFormat().resolvedOptions().timeZone);
	console.log("Manual TZ Offset: " + userTzOffset);
	console.log("Browser TZ Offset: " + browserTzOffset);

	var displayTz = -1 * browserTzOffset;
	$("#browser-tz-offset").text(`${displayTz >= 0 ? "+" : ""}${displayTz} hr`);

	if (browserTzOffset != currentBrowserTzOffset) {
		browserTzOffset = currentBrowserTzOffset;

		$.get(`./changeSetting?name=browserTzOffset&value=${browserTzOffset}`, function(data) {
			console.log("Browser timezone saved.");

			if (userTzOffset == "unset") {
				$(".date-text").each((i, obj) => {
					var timestampUtc = $(obj).attr("data-timestamp-utc");
					var includeAgo = $(obj).attr("data-date-ago");
					var formatStr = $(obj).attr("data-date-format");
					if (formatStr) {
						formatStr = `&formatString=${formatStr}`;
					}
					
					$.get(`./snippet/timestamp?timestamp=${timestampUtc}&includeAgo=${includeAgo}${formatStr}`, function(data) {
						$(obj).html(data);

						enableTooltipsAndPopovers();
					});
				});
			}
		});
	}
});
</script><script src="./js/highlight.min.js?v=2023-06-14-1dbd3d8fc2" integrity="sha384-rRRl92dHoFEuEUzbuZbirpL4mXU9lEC7sdPaMYmayIbFSr+1K2FNOGzSSnocSNq+" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded", function(event) {
	hljs.highlightAll();
});
</script><script src="./js/chart.min.js?v=2023-06-14-1dbd3d8fc2" integrity="sha384-9R67RXFKxJXd/+QmlkaEyOhcfa0gbkwDQ4LUr1RvuTZp9u4VDylkCdExAVOi6zqz" crossorigin="anonymous"></script><script>Chart.defaults.color='white';
var gridLineColor = "#1a4280";</script><script src="./js/decimal.js?v=2023-06-14-1dbd3d8fc2"></script><script>var satoshiPerByteBucketMaxima = [1,2,3,4,5,6,7,8,9,10,15,20,25,50,75,100,150];
var statusId = Math.random().toString(36).substr(2, 5);
var statusInterval;
var summary = null;

$(document).ready(function() {
	statusInterval = setInterval(function() { updateStatus(); }, 125);

	loadMempool();
});

function updateStatus() {
	$.ajax({
		url: `./internal-api/mempool-summary-status?statusId=${statusId}`

	}).done((res) => {
		if (!res.count) {
			// not started yet
			return;
		}

		var percent = new Decimal(res.done).dividedBy(res.count).times(100);

		$("#data-progress").css("width", `${percent.toDP(0)}%`);
		$("#progress-text").html(`<span class='fw-bold d-inline-block' style="width: 55px;">${percent.toDP(1)}%</span><span class='small fw-light ms-3'>(${res.done.toLocaleString()} of ${res.count.toLocaleString()})</span>`);

		if (res.done == res.count) {
			if (summary == null) {
				$.ajax({
					url: `./internal-api/get-mempool-summary?statusId=${statusId}`

				}).done((summaryResult) => {
					if (summaryResult && summaryResult.count) {
						summary = summaryResult;
					
						$("#json-content").text(JSON.stringify(summaryResult, null, 4));

						hljs.highlightAll();

						displaySummaryData(summaryResult);

						clearInterval(statusInterval);
					}
				}).always(() => {
					// nothing
				});
			}
		}
	}).fail((a, b, c) => {
	}).always(() => {
	});
}

function loadMempool() {
	$.ajax({
		url: `./internal-api/build-mempool-summary?statusId=${statusId}`

	}).done((buildResult) => {
		// we update status elsewhere, this call just kicks off the build

	}).fail((jqXHR, textStatus, errorThrown) => {
		$(".loading-error").html(`<h6 class='mt-4 text-danger'>Failed loading mempool:</h6><pre><code class='json'>${JSON.stringify(textStatus)}</code></pre><pre><code class='json'>${JSON.stringify(errorThrown)}</code></pre>`);

		hljs.highlightAll();

	}).always(() => {
	});
}

function displaySummaryData(summary) {
	var feeRateGraphData = buildFeeRateGraphData(summary);
	var txSizeGraphData = buildTxSizeGraphData(summary);
	var txAgeGraphData = buildTxAgeGraphData(summary);

	fillTopfeeTxTable(summary);
	fillOldestTxTable(summary);
	fillLargestTxTable(summary);

	//console.log(JSON.stringify(summary));

	$("#tx-count").text(summary.count.toLocaleString());
	$("#block-count").text(new Decimal(summary.totalWeight).dividedBy(4000000).toDP(1)); // TODO: magic number: block weight
	$("#total-fees").text(summary.totalFees);
	
	if (summary.count == 0) {
		$("#avg-fee").text("-");
		$("#avg-fee-rate").text("-");

		$("#detail-charts-and-data").hide();

		$("#main-content").show();
		$("#progress-wrapper").hide();

		return;
	}
	
	$("#avg-fee").text(summary.averageFee);
	$("#avg-fee-rate").text(summary.averageFeePerByte);

	$.ajax({
		url: `./internal-api/utils/formatLargeNumber/${summary.totalBytes},1`

	}).done(function(result) {
		$("#mem-usage").html(`<span>${result[0]} <small>${result[1].abbreviation}B</small></span>`);
	});

	updateCurrencyValue($("#total-fees"), summary.totalFees);
	updateCurrencyValue($("#avg-fee"), summary.averageFee);

	updateFeeRateValue($("#avg-fee-rate"), summary.averageFeePerByte, 2, false);


	//$("#summary-json").text(JSON.stringify(summary, null, 4));


	// fee rate chart
	var ctx1 = document.getElementById("mempoolBarChart").getContext('2d');
	var mempoolBarChart = new Chart(ctx1, {
		type: 'bar',
		data: {
			labels: feeRateGraphData.feeBucketLabels.reverse(),
			datasets: [
				/*{
					data: feeRateGraphData.lineData,
					type: "line",
					yAxisID: "axis-block-count",
					borderColor: "white",
					lineTension: 0,
					borderWidth: 2,
					pointRadius: 2
				},*/
				{
					data: feeRateGraphData.blockCounts.reverse(),
					backgroundColor: feeRateGraphData.bgColors,
					//yAxisID: "axis-tx-count",
				},
			]
		},
		options: {
			interaction: {
				intersect: false,
				mode: 'index',
			},
			plugins: {
				legend: {
					display: false
				},
			},
			scales: {
				x: {
					grid: {
						color: gridLineColor
					},
					title: {
						display: true,
						text: "Fee Rate (sat/vB)"
					},
				},
				y: {
					id: "axis-tx-count",
					title: {
						display: true,
						text: "Block Count"
					},
					type: 'logarithmic',
					ticks: {
						beginAtZero:true,
					},
					grid: {
						color: gridLineColor
					}
				},
				/*{
					id: "axis-block-count",
					position: "left",
					ticks: {
						beginAtZero:true,
					},
					grid: {
						color: gridLineColor
					}
				}*/
			}
		}
	});

	// tx size chart
	var ctx2 = document.getElementById("txSizesBarChart").getContext('2d');
	var txSizesBarChart = new Chart(ctx2, {
		type: 'bar',
		data: {
			labels: txSizeGraphData.sizeBucketLabels,
			datasets: [{
				data: txSizeGraphData.sizeBucketTxCounts,
				backgroundColor: txSizeGraphData.bgColors
			}]
		},
		options: {
			interaction: {
				intersect: false,
				mode: 'index',
			},
			plugins: {
				legend: {
					display: false
				},
			},
			scales: {
				x: {
					title: {
						display: true,
						text: "Transaction Size (bytes)"
					},
					grid: {
						color: gridLineColor
					}
				},
				y: {
					title: {
						display: true,
						text: "Transaction Count"
					},
					type: "logarithmic",
					ticks: {
						beginAtZero:true
					},
					grid: {
						color: gridLineColor
					}
				}
			}
		}
	});

	// tx age chart
	var ctx3 = document.getElementById("txAgesBarChart").getContext('2d');
	var txSizesBarChart = new Chart(ctx3, {
		type: 'bar',
		data: {
			labels: txAgeGraphData.ageBucketLabels,
			datasets: [{
				data: txAgeGraphData.ageBucketTxCounts,
				backgroundColor: txAgeGraphData.bgColors
			}]
		},
		options: {
			interaction: {
				intersect: false,
				mode: 'index',
			},
			plugins: {
				legend: {
					display: false
				},
			},
			scales: {
				x: {
					title: {
						display: true,
						text: "Transaction Age"
					},
					grid: {
						color: gridLineColor
					}
				},
				y: {
					title: {
						display: true,
						text: "Transaction Count"
					},
					type: "logarithmic",
					ticks: {
						beginAtZero:true
					},
					grid: {
						color: gridLineColor
					}
				}
			}
		}
	});


	// fee rate table
	var sumBlockCount = new Decimal(0);

	for (var i = (summary.satoshiPerByteBuckets.length - 1); i >= 0; i--) {
		var item = summary.satoshiPerByteBuckets[i];

		var row = $("#fee-rate-table-row-prototype").clone();
		row.attr("id", null);
		row.addClass("fee-rate-table-row");

		var blockCount = new Decimal(item.totalWeight).dividedBy(4000000); // TODO: magic number: block weight
		var sumBlockCount = sumBlockCount.plus(blockCount);

		row.find(".data-label").text(summary.satoshiPerByteBucketLabels[i]);
		row.find(".data-count").text(item.count.toLocaleString());
		row.find(".data-block-count").text(blockCount.toDP(2));
		row.find(".data-sum-block-count").text(sumBlockCount.toDP(2));
		row.find(".data-total-fees").text(item.count > 0 ? item.totalFees : "-");
		row.find(".data-avg-fee").text(item.count > 0 ? item.totalFees / item.count : "-");
		row.find(".data-fee-rate").text("-");

		if (item.count > 0) {
			updateCurrencyValue(row.find(".data-total-fees"), item.totalFees);
			updateCurrencyValue(row.find(".data-avg-fee"), item.totalFees / item.count);

			updateFeeRateValue(row.find(".data-fee-rate"), item.totalFees / item.totalBytes, 2, false);
		}

		row.show();

		$("#fee-rate-table-body").append(row);
	}
	

	$("#main-content").show();
	$("#progress-wrapper").hide();
}

function fillTopfeeTxTable(summary) {
	for (var i = 0; i < summary.highestFeeTxs.length; i++) {
		var topfeeTx = summary.highestFeeTxs[i];

		var row = $("#topfee-tx-table-row-prototype").clone();
		row.attr("id", null);
		row.addClass("topfee-tx-table-row");

		row.find(".data-txid").html(`<a href="./tx/${topfeeTx.txid}">${topfeeTx.txid.substring(0, 16)}...</a>`);

		row.find(".data-feerate").text(new Decimal(topfeeTx.feePerByte).times(4).toDP(1));

		row.show();

		$("#topfee-tx-table-body").append(row);
	}
}

function fillOldestTxTable(summary) {
	for (var i = 0; i < summary.oldestTxs.length; i++) {
		var oldTx = summary.oldestTxs[i];

		var row = $("#oldest-tx-table-row-prototype").clone();
		row.attr("id", null);
		row.addClass("oldest-tx-table-row");

		row.find(".data-txid").html(`<a href="./tx/${oldTx.txid}">${oldTx.txid.substring(0, 16)}...</a>`);

		var days = new Decimal(oldTx.age).dividedBy(1).dividedBy(60 * 60 * 24);

		if (days > 30) {
			var months = days.dividedBy(30);

			row.find(".data-age").text(months.toDP(2) + " mo");

		} else {
			row.find(".data-age").text(days.toDP(2) + " d");
		}

		row.show();

		$("#oldest-tx-table-body").append(row);
	}
}

function fillLargestTxTable(summary) {
	for (var i = 0; i < summary.largestTxs.length; i++) {
		var largeTx = summary.largestTxs[i];

		var row = $("#largest-tx-table-row-prototype").clone();
		row.attr("id", null);
		row.addClass("largest-tx-table-row");

		row.find(".data-txid").html(`<a href="./tx/${largeTx.txid}">${largeTx.txid.substring(0, 16)}...</a>`);

		var kb = new Decimal(largeTx.size).dividedBy(1000);

		row.find(".data-size").text(kb.toDP(2) + " kvB");

		row.show();

		$("#largest-tx-table-body").append(row);
	}
}

function buildFeeRateGraphData(summary) {
	var feeBucketLabels = [];
	
	var blockCounts = [];
	for (var i = 0; i < summary["satoshiPerByteBuckets"].length; i++) {
		var item = summary["satoshiPerByteBuckets"][i];

		if (i < summary["satoshiPerByteBuckets"].length - 1) {
			feeBucketLabels.push(item.minFeeRate);
			blockCounts.push(item.totalWeight / 4000000);
		}
	}

	feeBucketLabels.shift();

	var lineData = [];
	var totalWeight = 0;
	for (var i = summary.satoshiPerByteBuckets.length - 1; i >= 0; i--) {
		lineData.push(summary.satoshiPerByteBuckets[i].totalWeight / 4000000 + totalWeight);
		totalWeight += summary.satoshiPerByteBuckets[i].totalWeight / 4000000;
	}

	feeBucketLabels.push((summary.satoshiPerByteBucketMaxima[summary.satoshiPerByteBucketMaxima.length - 1] + "+"));
		
	var totalfeeBuckets = summary["satoshiPerByteBucketTotalFees"];
	
	var graphData = {
		feeBucketLabels:feeBucketLabels.map(x => [x]),
		bgColors:[],
		lineData:lineData,
		blockCounts:blockCounts
	};

	for (var i = 0; i < feeBucketLabels.length; i++) {
		var feeBucketLabel = feeBucketLabels[i];
		//var percentTx = Math.round(100 * feeBucketTxCounts[i] / summary.count).toLocaleString();
		
		//graphData.feeBucketLabels.push([feeBucketLabel]);//, `${feeBucketTxCounts[i]} tx (${percentTx}%)`]);
		graphData.bgColors.push(`hsl(${(333 * i / feeBucketLabels.length)}, 100%, 50%)`);
	}

	return graphData;
}

function buildTxSizeGraphData(summary) {
	var sizeBucketLabels = [];
	var bgColors = [];

	for (var i = 0; i < summary.sizeBucketLabels.length; i++) {
		var sizeBucketLabel = summary.sizeBucketLabels[i];
		var percentTx = Math.round(100 * summary.sizeBucketTxCounts[i] / summary.count).toLocaleString();

		sizeBucketLabels.push([`${sizeBucketLabel}`]);
		bgColors.push(`hsl(${(333 * i / summary.sizeBucketLabels.length)}, 100%, 50%)`);
	}

	return {
		sizeBucketLabels: sizeBucketLabels,
		bgColors: bgColors,
		sizeBucketTxCounts: summary.sizeBucketTxCounts
	};
}

function buildTxAgeGraphData(summary) {
	var ageBucketLabels = [];
	var bgColors = [];

	for (var i = 0; i < summary.ageBucketLabels.length; i++) {
		var ageBucketLabel = summary.ageBucketLabels[i];
		var percentTx = Math.round(100 * summary.ageBucketTxCounts[i] / summary.count).toLocaleString();

		ageBucketLabels.push([`${ageBucketLabel}`]);
		bgColors.push(`hsl(${(333 * i / summary.ageBucketLabels.length)}, 100%, 50%)`);
	}

	return {
		ageBucketLabels: ageBucketLabels,
		bgColors: bgColors,
		ageBucketTxCounts: summary.ageBucketTxCounts
	};
}

var notfoundEl = document.getElementById("mempoolquery");
var notfoundTooltip = new bootstrap.Tooltip(notfoundEl);

function estimateTransactionMempoolDepth(txid) {
	var avgTransactionsPerBlock = 3000;
	var satsPerBitcoin = 100000000; // TODO: magic number - replace with coinConfig.baseCurrencyUnit.multiplier
	
	$.ajax({
		url: `./internal-api/mempool-tx-summaries/${txid}`

	}).done(function(resultList) {
		if (resultList && resultList.length > 0) {
			var result = resultList[0];

			var feeRate = new Decimal(result.f).dividedBy(result.sz); // TODO: magic number, sat/BTC

			estimateMempoolDepth(feeRate);

		} else {
			notfoundTooltip.show();
			setTimeout(() => { notfoundTooltip.hide(); }, 2000);
		}
	});
}

function estimateMempoolDepth(feeRate) {
	feeRate = new Decimal(feeRate);
	
	if (feeRate > 1000) {
		$("#estimate-fee-rate").text(parseInt(feeRate).toLocaleString());

	} else {
		$("#estimate-fee-rate").text(new Decimal(feeRate).toDP(1));
	}

	var sumBlockCount = new Decimal(0);

	for (var i = (summary.satoshiPerByteBuckets.length - 1); i >= 0; i--) {
		var item = summary.satoshiPerByteBuckets[i];

		var blockCount = new Decimal(item.totalWeight).dividedBy(4000000); // TODO: magic number: block weight
		
		if (feeRate >= (item.minFeeRate || 1) && feeRate < (item.maxFeeRate || 10000000)) {
			// in this bucket
			var minBlocks = sumBlockCount;
			var maxBlocks = sumBlockCount.plus(blockCount);

			if (minBlocks < 1) {
				minBlocks = new Decimal(1);
			}

			if (maxBlocks < 1) {
				maxBlocks = new Decimal(1);
			}

			if (`${minBlocks.toDP(1)}` == `${maxBlocks.toDP(1)}`) {
				$("#estimate-mempooldepth").text(`~${minBlocks.toDP(1)}`);

			} else {
				$("#estimate-mempooldepth").text(`${Math.floor(minBlocks)} - ${Math.ceil(maxBlocks)}`);
			}
			
			var minMinutes = minBlocks.times(10); // TODO: magic number: 10min
			var maxMinutes = maxBlocks.times(10); // TODO: magic number: 10 min

			if (maxMinutes < 60) {
				if (`${minMinutes.toDP(1)}` == `${maxMinutes.toDP(1)}`) {
					$("#estimate-conf-time").text(`~${minMinutes.toDP(0)} min`);

				} else {
					$("#estimate-conf-time").text(`${minMinutes.toDP(0)} - ${maxMinutes.toDP(0)} min`);
				}
			} else if (maxMinutes < 60 * 24) {
				$("#estimate-conf-time").text(`${minMinutes.dividedBy(60).toDP(1)} - ${maxMinutes.dividedBy(60).toDP(1)} hr`);

			} else if (minMinutes < 60 * 24) {
				$("#estimate-conf-time").text(`${minMinutes.dividedBy(60).toDP(1)} hr - ${maxMinutes.dividedBy(60 * 24).toDP(1)} day`);

			} else {
				$("#estimate-conf-time").text(`${minMinutes.dividedBy(60 * 24).toDP(1)} - ${maxMinutes.dividedBy(60 * 24).toDP(1)} day`);
			}
		}

		sumBlockCount = sumBlockCount.plus(blockCount);
	}
}</script></body></html>